<div *ngIf="!isLoading">
  <div class="row">
    <h4><span *ngIf="!hasSelectedRdmp()"> In order to request/create a research workspace, please first select a plan. If you do not have one: <a class="btn btn-primary" href="{{ rdmpUrl }}">Create a Plan</a></span></h4>
    <br/>
  </div>
  <div class="row" *ngIf="createMode">
    <h4 *ngIf="!hasSelectedRdmp()">{{ searchLabel }}</h4>
    <rb-RelatedObjectSelector [field]="selectorField"></rb-RelatedObjectSelector>
    <button (click)="cancelCreate()" class="btn btn-primary">{{ backButtonLabel }}</button>
  </div>
  <div class="row" *ngIf="!createMode">
    <button type='button' (click)="createWorkspace()" class="btn btn-primary"> {{ createWorkspaceLabel }} </button>
  </div>
  <br />
  <div class="container">
    <div class="row justify-content-center" [ngClass]="hasSelectedRdmp() ? 'block' : 'overlay'">
      <div class="row">
        <div class="card-deck">
          <div class="card service col-lg-4 col-md-5 col-sm-6 col-xs-12" *ngFor="let s of services" style="display: flex; flex-direction: column;width: 30rem;">
            <div class="panel panel-default">
              <div class="panel-heading">
                <h5 class="panel-title card-title" style="margin-top: 1px">
                  <span *ngIf="s.displayName">{{ s.displayName }}</span>
                </h5>
              </div>
              <div class="panel-body workspaces-panel-body">
                <img style="max-height:100px;" class="card-img-top" src="{{ s.logo }}" alt="{{ s.name }}">
                <div class="card-body" style="margin-bottom: auto;">
                  <h5 class="card-title" style="margin-top: 2px">
                    <span *ngIf="s.title">{{ s.title }}</span>
                  </h5>
                  <p class="card-text">{{ s.desc }}</p>
                </div>
              </div>
              <div class="card-footer" style="margin-top: auto;">
                <a *ngIf="selectedRdmpUrl" [attr.disabled]="hasSelectedRdmp() ? null : ''" [href]="goToWorkspace(s.app)" class="btn btn-block btn-primary">{{ nextButtonLabel }}</a>
              </div>
            </div>
          </div>
          <br />
        </div>
      </div>
    </div>
  </div>
  <div class="row"></div>
  <div *ngIf="records.totalItems > 0 && !createMode">
    <h2>Your research spaces</h2>
    <table class="table">
      <thead>
        <tr>
          <th>{{ recordColLabel }}</th>
          <th>{{ descriptionColLabel }}</th>
          <th>{{ linkColLlabel }}</th>
          <th>{{ rdmpColLabel }}</th>
          <th>{{ typeColLabel }}</th>
        </tr>
      </thead>
      <tbody *ngFor="let plan of records.items">
        <tr>
          <td>
            {{ plan.dashboardTitle }}
          </td>
          <td>{{ plan.metadata.metadata.description }}</td>
          <td><a target="_blank" rel="noopener noreferrer" href="{{ plan.metadata.metadata.location }}">{{ plan.metadata.metadata.location }}</a></td>
          <td><a href="/{{ branding }}/{{ portal }}/record/view/{{ plan.metadata.metadata.rdmpOid }}">{{ plan.metadata.metadata.rdmpTitle }}</a></td>
          <td>{{ plan.metadata.metadata.type }}</td>
        </tr>
      </tbody>
    </table>

    <pagination *ngIf="records.totalItems > 0" [directionLinks]="false" [boundaryLinks]="true" [totalItems]="records.totalItems" [(ngModel)]="records.currentPage" (pageChanged)="pageChanged($event)" class="pagination-sm"></pagination>
  </div>
</div>
